$(function() {
    function e() {
        var e = $(".baners .row"),
            o = $(".categories__content");
        window.matchMedia("(max-width: 576px)").matches ? (o.hasClass("slick-initialized") || o.slick({
            dots: !1,
            arrows: !1,
            slidesToShow: 1,
            rtl: true, //на англ версии его не должно быть
            centerMode: !0,
            speed: 300,
            centerPadding: "100px"
        }), e.hasClass("slick-initialized") || e.slick({
            dots: !1,
            arrows: !1,
            rtl: true, //на англ версии его не должно быть
            infinite: !0,
            speed: 300,
            slidesToShow: 1,
            centerMode: !0,
            centerPadding: "80px"
        })) : (e.hasClass("slick-initialized") && e.slick("unslick"), o.hasClass("slick-initialized") && o.slick("unslick"))
    }



    function o() {
    }

    function t() {
        var e = $(document).scrollTop(),
            o = $("#second-menu");
            if(!$('body').hasClass('open-search')){
            o.offset().top + o.height() < e ? ($(".top-header").addClass("fixed-menu"), $("body").addClass("show-fixed-menu")) : ($("body").removeClass("show-fixed-menu"), $(".top-header").removeClass("fixed-menu"))
        }
        else{
            o.offset().top + o.height() < e ? ($(".top-header").addClass("nono")) : ($("body").removeClass("show-fixed-menu"), $(".top-header").removeClass("fixed-menu"))
        }
    }
    $(document).ready(function() {
        $(function() {
          $(".modal-nav-list").swipe( {
            swipeLeft:function(event, direction) {
                $(this).animate({'margin-left':'-330px'},100);
                // $(this).fadeOut(300);
                $(".top-header__overlay").fadeOut(100);  
             }
          });

        });


        $(".carousel .carousel-inner").slick({
            dots: !0,
            arrows: !0,
            pauseOnHover: !1,
            pauseOnDotsHover: !1,
            rtl: true, //на англ версии его не должно быть
            autoplay: !0,
            autoplaySpeed: 4700,
            prevArrow: '<a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev"><span class="carousel-control-prev-icon" aria-hidden="true"></span></a>',
            nextArrow: '<a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next"> <span class="carousel-control-next-icon" aria-hidden="true"></span> </a>'
        }), $(".featured__list-carusel").slick({
            dots: !0,
            arrows: !1
        }), $(".product-carousel").slick({
            dots: !0,
            rtl: true, //на англ версии его не должно быть
            arrows: !1
        }), $(".advantages__slider >div").slick({
            dots: !0,
            arrows: !0,
            rtl: true,
            adaptiveHeight: !0
        }), $(".advantages__slider-link").on("click", function() {
            $(".slick-next").trigger("click")
        }), $(function() {
            jQuery("img.svg").each(function() {
                var t = jQuery(this),
                    s = t.attr("id"),
                    a = t.attr("class"),
                    e = t.attr("src");
                jQuery.get(e, function(e) {
                    var o = jQuery(e).find("svg");
                    void 0 !== s && (o = o.attr("id", s)), void 0 !== a && (o = o.attr("class", a + " replaced-svg")), !(o = o.removeAttr("xmlns:a")).attr("viewBox") && o.attr("height") && o.attr("width") && o.attr("viewBox", "0 0 " + o.attr("height") + " " + o.attr("width")), t.replaceWith(o)
                }, "xml")
            })
        }), $(function() {
        if ($(window).width() <= '767'){
           $(".profile-link a").appendTo(".drop-account");
            }
        }),

        $( window ).resize(function() {
          if ($(window).width() <= '767'){
           $(".profile-link a").appendTo(".drop-account");
            }
          if ($(window).width() <= '767'){
                $(".type-section").appendTo(".modal-list-type .insert");
                $(".price-section").appendTo(".modal-list-price .insert");
                $(".color-section").appendTo(".modal-list-color .insert");
                $(".category-page__grid-sorting li").appendTo(".modal-list-sort .insert ul");
            }

            if ($("div").is(".search-city") && $(window).width() <= '767') {
                var placeholder = $(".search-city input").attr('data-placeholder-mobile');
                $('.search-city form input[type=text]').attr("placeholder", placeholder).placeholder();
            }

        }),
         $.fn.AddXbutton = function(e) {
            var o = $.extend({
                img: "x.gif"
            }, e);
            $obj = $(this), $(this).each(function(e) {
                $(this).after($('<div class="close" type="image" id="xButton' + e + '" src="' + o.img + '" />').css({
                    display: "none",
                    cursor: "pointer",
                    width: " 30px",
                    height: "auto",
                    position: "relative",
                    "z-index": "10"
                }).click(function() {
                    $obj.val("").focus(), $("#xButton" + e).hide(), $(".list-result").hide()
                })).keyup(function() {
                    0 < $(this).val().length ? ($("#xButton" + e).show(), $(".list-result").fadeIn()) : ($("#xButton" + e).hide(), $(".list-result").hide()), "" != $(this).val() && $("#xButton" + e).show()
                })
            })
        }, $(document).ready(function() {

          if ($(window).width() <= '767'){
                $(".type-section").appendTo(".modal-list-type .insert");
                $(".price-section").appendTo(".modal-list-price .insert");
                $(".color-section").appendTo(".modal-list-color .insert");
                $(".category-page__grid-sorting li").appendTo(".modal-list-sort .insert ul");
                
            }
            $("#search").AddXbutton({
                img: "assets/images/icons/ic_close_gray.svg"
            })
        }), $(".top-header__search a").on("click", function(event ) {
            event.preventDefault();
            $(".top-header__search-conteiner").addClass('opened'),$(".top-header__search-result").fadeIn(0), $('.searchInput').focus(), $("body .overlay").fadeIn(200), $("body").addClass("open-search"), $(".right-container").addClass("opened");
        }), $(".top-header__cart").on("click", function(e) {
            event.preventDefault();
            $(".top-header__cart-mini").fadeIn(0), $("body .overlay").fadeIn(300), $("body").addClass("open-search");
        }), $(".overlay").on("click", function(e) {
            $(".top-header__cart-mini").fadeOut(0);
            $(".top-header__search-result").fadeOut(200);
            $("body .overlay").fadeOut(300);
            $(".top-header__search-conteiner").removeClass('opened');
            $(".social-link").slideUp(300);
            $(".account__prof").removeClass('open');
            $(".account__prof").parent().removeClass('open');
            $(".socki-mob-button").removeClass('open');
            $(".socki-mob-button").parent().removeClass('open');
            $(".drop-account").slideUp(300);
            $("body").removeClass("open-search");
            $(".right-container").removeClass("opened");
        }), $(".comparison").on("click", function() {
            $(this).toggleClass("active")
        }), $(".product-buttons__comparison").on("click", function(e) {
            e.preventDefault(), $(this).toggleClass("active")
        }), $(".add-cart, .product-buttons__add-cart").on("click", function(e) {
            e.preventDefault(), $(this).toggleClass("added");
            var text = $(this).text();
            $(this).text($(this).attr('data-add'));
            $(this).attr('data-add', text);
        }), $(document).on("click", ".featured__list-wish", function(e) {
            e.preventDefault(), $(this).stop().toggleClass("active")
        }), $(document).on("click", ".favorite__add", function(e) {
            e.preventDefault();
            var o = $(this).closest(".favorite");
            o.stop().toggleClass("active"), o.hasClass("active") && (o.find(".favorite__link").addClass("active"), setTimeout(function() {
                o.find(".favorite__link").removeClass("active")
            }, 1e3))
        }), $(".ocassions__bottom").on("click", function(e) {
            e.preventDefault(), $(".ocassions__content > div:nth-child(n+9)").slideToggle();
            var text = $(this).children(".ocassions__bottom-content").children(".ocassions__bottom-all").contents().get(0).nodeValue;
            var spantext = $(this).children(".ocassions__bottom-content").find(".ocassions__bottom-all span").text();
            var texthide = $(this).children(".ocassions__bottom-content").children(".ocassions__bottom-all").attr('data-hide-text');
            var spantexthide = $(this).children(".ocassions__bottom-content").find(".ocassions__bottom-all span").attr('data-hide-text');
            $(this).children(".ocassions__bottom-content").find(".ocassions__bottom-all span").attr('data-hide-text', spantext);
            $(this).children(".ocassions__bottom-content").children(".ocassions__bottom-all").attr('data-hide-text', text);

            if($(this).hasClass('opened')){
                var id  = "#ocassions",
                    top = $(id).offset().top;
                $('body,html').animate({scrollTop: top}, 700);
            }
            $(this).toggleClass('opened');
            var clas = "return"
            if($(this).children(".ocassions__bottom-content").find(".ocassions__bottom-all span").hasClass('return')){
                clas = "";
            }
            var str = texthide + "<span class='" + clas + "' data-hide-text='" + spantext + "''>" + spantexthide + "</span>";
            $(this).children('.ocassions__bottom-content').children(".ocassions__bottom-all").html(str);

        }), $(document).on("click", ".mobile-category", function(e) {
            e.preventDefault();
            var o = $(this),
                t = o.find(".show_category"),
                a = $("#mobile-category"),
                n = a.find("> ul");
            o.hasClass("active") || (o.addClass("active"), $(".burger").addClass('open'), a.addClass("relative"), n.addClass("mobile_list"), t.addClass("open"), $("body .overlay").fadeIn(300), n.stop().slideDown(300), $("body").addClass("show-category"), $(document).mouseup(function(e) {
                0 === $(".mobile-category-menu").has(e.target).length && n.stop().slideUp(300, function() {
                    o.removeClass("active"), $(".burger").removeClass('open'), a.removeClass("relative"), n.removeClass("mobile_list"), t.removeClass("open"), $("body .overlay").fadeOut(300), $("body").removeClass("show-category")
                })
            }))
        }), $(".mobile-nav").on("click", function() {
            $("ul.navbar-nav.mr-auto .top-header__languages").prependTo(".top-header__dropdowns"), $("ul.navbar-nav.mr-auto .top-header__currency").prependTo(".top-header__dropdowns"), $(".modal-nav-list").fadeIn(100), $(".modal-nav-list").animate({'margin-left':'-15px'},100), $(".top-header__overlay").fadeIn(100), $("body, html").addClass("show-menu"), $(document).mouseup(function(e) {
                var o = $(".modal-nav-list");
                0 === o.has(e.target).length && (o.hide(100), $(".top-header__overlay").hide(100), $("html, body").removeClass("show-menu"))
            })
        }), $(".top-header__close").on("click", function() {
            $(".modal-nav-list").hide(100), $(".top-header__overlay").hide(100), $("html, body").removeClass("show-menu")
        }), $(".top-header__overlay").on("click", function() {
            $(".modal-nav-list").hide(100), $(".top-header__overlay").hide(100), $("html, body").removeClass("show-menu")
        }), $(document).on("click", ".dropdown-mobile-menu .nav-link", function(e) {
            e.preventDefault();
            var o = $(this).closest(".dropdown-mobile-menu"),
                t = o.find(".dropdown-menu");
            $(document).mouseup(function(e) {
                    0 === o.has(e.target).length && (t.removeClass("show"), o.removeClass("open"), $('.top-header__links').removeClass('opened-two'))
            })
                

            if($('.dropdown-menu').hasClass("show")){
                $('.top-header__links').addClass('opened-two');
            }
            else{
                $('.top-header__links').removeClass('opened-two');
            }
        })
    }), $(document).ready(function() {
        e(), o(), t()
    }), $(window).resize(function() {
        e(), o()
    }), $(window).scroll(function() {
        t()
    })
}), $(document).ready(function() {
    if ($(window).width() > '767') {
        $(".contacts__tabs--body").slick({
            slidesToShow: 1,
            slidesToScroll: 1,
            arrows: !1,
            fade: !0,
            asNavFor: ".contacts__tabs--head"
        })
    }
    $(".contacts__tabs--head").slick({
        slidesToShow: 4,
        asNavFor: ".contacts__tabs--body",
        dots: !1,
        centerMode: !0,
        centerPadding: "0px",
        focusOnSelect: !0
    }), 576 < $(window).width() ? $(".comparison__content--slider").slick({
        slidesToShow: 3,
        touchThreshold: 12,
        appendArrows: $(".comparison__content--slider-btn")
    }) : $(".comparison__content--slider").slick({
        slidesToShow: 2,
        touchThreshold: 12,
        appendArrows: $(".comparison__content--slider-btn")
    }), $(".del").click(function(e) {
        $(this).parent().parent().remove()
    }), $(document).on("click", ".reviews__feedback-give", function(e) {
        e.preventDefault(), $("#feedback").modal("show")
    })
}), $(document).ready(function() {
    if ($("div").is(".search-city") && $(window).width() <= '767') {
        var placeholder = $(".search-city input").attr('data-placeholder-mobile');
        $('.search-city form input[type=text]').attr("placeholder", placeholder).placeholder();
    }
    const menu = document.querySelector("svg.burger");
    menu.addEventListener("click", morph);

    function morph() {
      menu.classList.toggle("open");
    }
    
    $(".product__title a p").shorten();
    $(".product__description p").shorten();

    $(".modal-form").find(".modal-form__input input, .modal-form__input textarea").focus(function() {
        $(this).closest(".modal-form__input").addClass("focus")
    }), $(".modal-form").find(".modal-form__input input, .modal-form__input textarea").blur(function() {
        0 == $(this).val().length && $(this).closest(".modal-form__input").removeClass("focus")
    })

    $("#tabs-wrap>div").hide(); // Скрываем содержание
    $("#tabs li:first").attr("id","current"); // Активируем первую закладку
    $("#tabs-wrap>div:first").fadeIn(); // Выводим содержание

    $('#tabs a').click(function(e) {
        e.preventDefault();
        $("#tabs-wrap>div").hide(); //Скрыть все сожержание
        $("#tabs li").attr("id",""); //Сброс ID
        $(this).parent().attr("id","current"); // Активируем закладку
        $('#' + $(this).attr('title')).show(0); // Выводим содержание текущей закладки
    });
    $('.close-block').click(function(e) {
        $(this).parent().hide(300);
    });


    $( ".history-list__text ul" ).each(function() { 
        var n = $(this).children('li').length;
        if(n>2){
        $(this).parent().append("<p class='button-open-list'>"+ $(this).attr('data-overflow') +"</p>");
        $(this).addClass('toggled');
        }
    });
    
    $(".button-open-list").click(function(){
        $(this).parent().toggleClass('open');
        var text;
        if ($(this).parent().hasClass('open')){
            text = $(this).prev().attr('data-hide');
        }
        else{
            text = $(this).prev().attr('data-overflow');
        }
        $(this).text(text);
    });
    $(".mob-accordeon").click(function(){
        $(".mob-accordeon.opened").not($(this)).parent().next().slideUp(300);
        $(".mob-accordeon.opened").not($(this)).removeClass('opened');
        $(this).toggleClass('opened');
        $(this).parent().next().slideToggle(300);
    });
    $("#fast-seen .prev-product").click(function(){
        $(this).nextAll(".modal-body").fadeOut(200);
        $(this).nextAll(".modal-body").fadeIn(200);
    });
    $("#fast-seen .next-product").click(function(){
        $(this).nextAll(".modal-body").fadeOut(200);
        $(this).nextAll(".modal-body").fadeIn(200);
    });
    
    $(".edit-profile").click(function(e) {
        e.preventDefault();
        $('.profile__info').removeClass('actives');
        $('.profile__edit').addClass('actives');
    });
    $(".cancel-edit").click(function(e) {
        e.preventDefault();
        $('.profile__edit').removeClass('actives');
        $('.profile__info').addClass('actives');
    });
    $(".cancel-button-edit").click(function(e) {
        e.preventDefault();
        $('.profile__edit').removeClass('actives');
        $('.profile__info').addClass('actives');
    });
    $(".reg-butt").click(function(){
        $(this).prevAll($('.code-via-sms')).fadeIn(300);
    });
    $(".tab-m1").click(function(){
        $('.tab-m2').removeClass('active');
        $('.tab-m1').addClass('active');
        $('.tab-f2').hide();
        $('.tab-f1').show();
    });
    $(".tab-m2").click(function(){
        $('.tab-m1').removeClass('active');
        $('.tab-m2').addClass('active');
        $('.tab-f1').hide();
        $('.tab-f2').show();
    });
    $(".gender-trigger").click(function(){
        $(".gender-trigger.active").removeClass('active');
        $(this).addClass('active');
    });
    if ($(".select-pro").length){
        $('.select-pro').fancySelect();
    }
    $(".add-address").click(function() {
        var n = $("#inputs-list").children('label').length;
        if(n<2){
            $("#inputs-list").append('<label for="" class="dop-inp1"><div class="close-input"></div><input type="text" placeholder="Your second address" /></label>');
            $('.two-inps').show();
        }
        else{
            $("#inputs-list").append('<label for="" class="dop-inp2"><div class="close-input"></div><input type="text" placeholder="Your third address" /></label>');
            $('.three-inps').show();
            $(this).hide();
        }
    });
    $('#inputs-list').on('click', '.close-input', function() {
        if($('.three-inps').is(':visible')){
            $('.dop-inp2').remove();
            $('.three-inps').hide();
            $(".add-address").show();
        }
        else{            
            $('.dop-inp1').remove();
            $('.two-inps').hide();
        }

    });

   
    $(".dropdown-hover" ).hover(
        function() {
            if ($(window).width() > 1200) {
                $(this).children('.dropdown-menu').stop().fadeIn(150);
                $(this).children('.dropdown-menu').addClass('show');
                $(this).addClass('open');

            }
              }, function() {
                if ($(window).width() > 1200) {
                $(this).children('.dropdown-menu').stop().fadeOut(150);
                $(this).children('.dropdown-menu').removeClass('show');
                $(this).removeClass('open');
            }
        }
    ); 
    $(document).on("click", ".dropdown-hover a", function(e) {
        if(!$(this).parent().hasClass('noshowontablet')){
            e.preventDefault();
            var o = $(this).parent().closest(".dropdown-hover"),
                t = o.parent().find(".dropdown-menu");
            if ($(window).width() < 1200) 
            {
                if($(this).parent().hasClass('open')){
                    $(this).nextAll('.dropdown-menu').stop().fadeOut(300);
                    $(this).nextAll('.dropdown-menu').removeClass('show');
                    $(this).parent().removeClass('open');
                }
                else{
                    $(this).nextAll('.dropdown-menu').stop().fadeIn(150);
                    $(this).nextAll('.dropdown-menu').addClass('show');
                    $(this).parent().addClass('open');
                }
                $(document).mouseup(function(e) {
                    0 === o.has(e.target).length && (t.removeClass("show"), o.removeClass("open"), $('.top-header__links').removeClass('opened-two'))
                });
            }
        }                
    });


    

    $(document).mouseup(function (e) {
        var container = $(".dropdown-menu");
        if (container.has(e.target).length === 0){
            container.hide();
        }
    });

    $('.color-select__item input').change(function() {
        var color = $(this).attr('data-color');
        if(color == "No matter"){
            $(this).parent().parent().parent().prev().children('.product-options__close').hide();
        }
        else{
            $(this).parent().parent().parent().prev().children('.product-options__close').css("display", "inline-block");
        }
        $(this).parent().parent().parent().prev().children('span').text(color);
    });
    $('.size-select__item input').change(function() {
        var size = $(this).attr('data-size');
        if(size == "No matter"){
            $(this).parent().parent().parent().prev().children('.product-options__close').hide();
        }
        else{
            $(this).parent().parent().parent().prev().children('.product-options__close').css("display", "inline-block");
        }
        $(this).parent().parent().parent().prev().children('span').text(size);
    });
    $(".product-options__close.colores").click(function(e) {
        e.preventDefault();
        $(this).prev().text('No matter');
        $(this).hide();
        $(this).parent().next().children().children().children('input').prop('checked', true);
    });
    $(".product-options__close.sizes").click(function(e) {
        e.preventDefault();
        $(this).prev().text('No matter');
        $(this).hide();
        $(this).parent().next().children().children().children('input').prop('checked', true);
        $(this).parent().next().children().children().children('input').prop('checked', false);
    });

    $(".product-quantity__remove").click(function(e) {
        e.preventDefault();
        var n = $(this).next('input').val();
        if (n>1) {            
            n--;
        }
        $(this).next('input').val(n);
        $(this).css("visibility", "visible");
        $(this).nextAll(".product-quantity__add").css("visibility", "visible");
    });

    $(".reviews__feedback-show").click(function(e) {
        e.preventDefault();
        $('.reviews__slider .col-lg-4:lt(6)').slideDown(300);
    });
    $(".description__read-more").click(function(e) {
        e.preventDefault();
        $(this).prev().toggleClass("open");        
        var text = $(this).text();
        var hidetext = $(this).attr("data-overflow");
        $(this).attr("data-overflow", text);
        $(this).text(hidetext);
    });
    $(".product-quantity__add").click(function(e) {
        e.preventDefault();
        var n = $(this).prev('input').val();
        n++;
        $(this).prev('input').val(n);
        $(this).css("visibility", "visible");
        $(this).prevAll(".product-quantity__remove").css("visibility", "visible");
    });
    $(document).mouseup(function (e) {
        var container = $(".product-quantity");
        if (container.has(e.target).length === 0){
            $(".product-quantity__remove").css("visibility", "hidden");
            $(".product-quantity__add").css("visibility", "hidden");
        }
    });
    $(".account__prof").click(function(e) {
       if ($(window).width() <= '768'){
           $(this).toggleClass("open");
           if($('.social-link').is(":visible")){
                $('.social-link').slideUp(300);
                $(".socki-mob-button").removeClass('open');
                $(".socki-mob-button").parent().removeClass('open');
           }
           else{
                $("body .overlay").fadeToggle(300);
           }
           $('.drop-account').slideToggle();
       }
    });
    $(".remove.close").click(function(e) {
       $(this).parent().parent().hide(300);
    });
    $('.overlay-filter').click(function(e) {
        $("#filter-list li.open").children(".modal-list").slideUp(300);
        $("#filter-list li.open").removeClass("open");
       $('.overlay-filter').fadeOut(300);
    });
    $("#filter-list li a").click(function(e) {
        e.preventDefault();
        $("#filter-list li.open").not($(this).parent()).children(".modal-list").slideUp(300);
        $("#filter-list li.open").not($(this).parent()).removeClass("open");
        $(this).parent().toggleClass('open');
       $(this).next(".modal-list").slideToggle(300);
       $('.overlay-filter').fadeToggle(300);
    });
    $(".socki-mob-button").click(function(e) {
       if ($(window).width() <= '768'){
         
           $(this).toggleClass("open");
           $(this).parent().toggleClass("open");
           $('.social-link').slideToggle(300);
           $("body .overlay").fadeToggle(300);
       }
    });
    $(".product-quantity input").focus(function() {
        $(this).prev().css("visibility", "visible");
        $(this).next().css("visibility", "visible");
    });
    $(".product-quantity input").blur(function() {
        $(this).prev().css("visibility", "hidden");
        $(this).next().css("visibility", "hidden");
    });
});

 (function($) {
    $.fn.shorten = function (settings) {
    
        var config = {
            showChars: 50,
            ellipsesText: "...",
            moreText: "",
            lessText: ""
        };

        if ($(window).width() < 1199 && $(window).width() > 767) {
            var config = {
                showChars: 40,
                ellipsesText: "...",
                moreText: "",
                lessText: ""
            };
        }

        if ($(window).width() < 767) {
            var config = {
                showChars: 35,
                ellipsesText: "...",
                moreText: "",
                lessText: ""
            };
        }

        if (settings) {
            $.extend(config, settings);
        }
        
        $(document).off("click", '.morelink');
        
        $(document).on({click: function () {

                var $this = $(this);
                if ($this.hasClass('less')) {
                    $this.removeClass('less');
                    $this.html(config.moreText);
                } else {
                    $this.addClass('less');
                    $this.html(config.lessText);
                }
                $this.parent().prev().toggle();
                $this.prev().toggle();
                return false;
            }
        }, '.morelink');

        return this.each(function () {
            var $this = $(this);
            if($this.hasClass("shortened")) return;
            
            $this.addClass("shortened");
            var content = $this.html();
            if (content.length > config.showChars) {
                var c = content.substr(0, config.showChars);
                var h = content.substr(config.showChars, content.length - config.showChars);
                var html = c + '<span class="moreellipses">' + config.ellipsesText + ' </span><span class="morecontent"><span>' + h + '</span> <a href="#" class="morelink">' + config.moreText + '</a></span>';
                $this.html(html);
                $(".morecontent span").hide();
            }
        });
        
    };

 })(jQuery);


